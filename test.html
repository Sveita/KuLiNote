<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Diary Notes</title>
    <style>
      /* Add some basic styles */
      #columns {
        display: flex;
        flex-direction: column;
      }
      .note {
        border: 1px solid #000;
        margin: 10px;
        padding: 10px;
      }
      #iconContainer {
        display: flex;
        justify-content: space-between;
      }
      button {
        margin: 5px;
      }
    </style>
  </head>
  <body>
    <div>
      <form id="create-form">
        <input type="text" id="title" placeholder="Title" required />
        <textarea id="content" placeholder="Content" required></textarea>
        <input type="date" id="date" required />
        <button type="submit">Add Note</button>
      </form>
    </div>

    <div id="columns"></div>

    <script>
      const noteContainer = document.getElementById("columns");
      const createForm = document.querySelector("#create-form");

      // Load diary notes from localStorage
      const loadDiaries = () => {
        const diaryArr = JSON.parse(localStorage.getItem("diaryArray")) || [];
        noteContainer.innerHTML = "";
        diaryArr.forEach((diary) => createNoteElement(diary));
      };

      // Create note element
      const createNoteElement = ({ id, title, content, date }) => {
        const noteElement = document.createElement("div");
        noteElement.classList.add("note");
        noteElement.innerHTML = `
        <div id="iconContainer">
          <button onclick="editDiary(${id})"><img src="./image/edit.png" alt="Edit" id="edit-${id}" /></button>
          <button onclick="deleteDiary(${id})"><img src="./image/trash.png" alt="Delete" id="delete-${id}" /></button>
        </div>
        <h2 id="userInputTitle">${title}</h2>
        <h3 id="userInputContent">${content}</h3>
        <h4 id="userInputDate">${date}</h4>
      `;
        noteContainer.appendChild(noteElement);
      };

      // Add note
      createForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const title = document.querySelector("#title").value;
        const content = document.querySelector("#content").value;
        const date = document.querySelector("#date").value;
        createDiary(title, content, date);
        createForm.reset();
      });

      const createDiary = (title, content, date) => {
        const diaryArr = JSON.parse(localStorage.getItem("diaryArray")) || [];
        const newDiary = {
          id: Date.now(),
          title,
          content,
          date,
        };
        diaryArr.push(newDiary);
        localStorage.setItem("diaryArray", JSON.stringify(diaryArr));
        createNoteElement(newDiary);
      };

      // Edit note
      window.editDiary = (id) => {
        const diaryArr = JSON.parse(localStorage.getItem("diaryArray")) || [];
        const diary = diaryArr.find((diary) => diary.id === id);
        if (diary) {
          document.querySelector("#title").value = diary.title;
          document.querySelector("#content").value = diary.content;
          document.querySelector("#date").value = diary.date;
          deleteDiary(id);
        }
      };

      // Delete note
      window.deleteDiary = (id) => {
        let diaryArr = JSON.parse(localStorage.getItem("diaryArray")) || [];
        diaryArr = diaryArr.filter((diary) => diary.id !== id);
        localStorage.setItem("diaryArray", JSON.stringify(diaryArr));
        loadDiaries();
      };

      // Initial load
      loadDiaries();
    </script>
  </body>
</html>
